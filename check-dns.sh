#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ DNS –∑–∞–ø–∏—Å–µ–π –¥–æ–º–µ–Ω–∞ alexautozakup.kz

DOMAIN="alexautozakup.kz"
EXPECTED_IP="85.198.89.34"

echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ DNS –∑–∞–ø–∏—Å–µ–π –¥–ª—è $DOMAIN"
echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –¥–æ–º–µ–Ω–∞
echo ""
echo "üìå –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –¥–æ–º–µ–Ω–∞: $DOMAIN"
RESULT=$(dig +short $DOMAIN 2>/dev/null | tail -1)

if [ -z "$RESULT" ]; then
    echo "‚ùå DNS –∑–∞–ø–∏—Å—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –∏–ª–∏ –Ω–µ –æ–±–Ω–æ–≤–∏–ª–∞—Å—å"
    echo "‚è≥ –ü–æ–¥–æ–∂–¥–∏—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç - DNS –∑–∞–ø–∏—Å–∏ –º–æ–≥—É—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—Ç—å—Å—è –¥–æ 48 —á–∞—Å–æ–≤"
    exit 1
elif [ "$RESULT" == "$EXPECTED_IP" ]; then
    echo "‚úÖ DNS –∑–∞–ø–∏—Å—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞: $RESULT"
else
    echo "‚ö†Ô∏è  DNS –∑–∞–ø–∏—Å—å –Ω–∞–π–¥–µ–Ω–∞, –Ω–æ IP –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç: $RESULT (–æ–∂–∏–¥–∞–µ—Ç—Å—è $EXPECTED_IP)"
    exit 1
fi

# –ü—Ä–æ–≤–µ—Ä–∫–∞ www –ø–æ–¥–¥–æ–º–µ–Ω–∞
echo ""
echo "üìå –ü—Ä–æ–≤–µ—Ä–∫–∞ www –ø–æ–¥–¥–æ–º–µ–Ω–∞: www.$DOMAIN"
WWW_RESULT=$(dig +short www.$DOMAIN 2>/dev/null | tail -1)

if [ -z "$WWW_RESULT" ]; then
    echo "‚ö†Ô∏è  www –ø–æ–¥–¥–æ–º–µ–Ω –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω (–Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)"
elif [ "$WWW_RESULT" == "$EXPECTED_IP" ]; then
    echo "‚úÖ www –ø–æ–¥–¥–æ–º–µ–Ω –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ: $WWW_RESULT"
else
    echo "‚ö†Ô∏è  www –ø–æ–¥–¥–æ–º–µ–Ω –Ω–∞—Å—Ç—Ä–æ–µ–Ω, –Ω–æ IP –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç: $WWW_RESULT"
fi

echo ""
echo "‚úÖ DNS –∑–∞–ø–∏—Å–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ!"
echo "üöÄ –ú–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–æ–µ–∫—Ç:"
echo "   docker-compose up -d"

